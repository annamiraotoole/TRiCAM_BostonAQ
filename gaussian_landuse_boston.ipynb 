{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import sys\n",
    "import numpy as np\n",
    "import scipy as sp\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import sklearn as sk\n",
    "from sklearn import mixture\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn import preprocessing\n",
    "from statsmodels.tools import add_constant\n",
    "from sklearn.gaussian_process import GaussianProcessRegressor\n",
    "from sklearn.gaussian_process.kernels import RBF\n",
    "from sklearn.gaussian_process.kernels import ConstantKernel as C\n",
    "from sklearn.gaussian_process.kernels import Matern, WhiteKernel, RationalQuadratic, DotProduct\n",
    "import statsmodels.api as sm\n",
    "sns.set(style=\"ticks\")\n",
    "import random\n",
    "# import tensorflow as tf\n",
    "from matplotlib import pyplot as plt\n",
    "# import GPflow\n",
    "# import george\n",
    "# george.__version__\n",
    "# from george import kernels\n",
    "import os\n",
    "import pickle\n",
    "%matplotlib inline\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "df = pd.read_csv(\"appendedAQ.csv\")\n",
    "df_cells = pd.read_csv(\"boston_site_LU.csv\")\n",
    "\n",
    "lat = df[\"Latitude\"]\n",
    "lon = df[\"Longitude\"]\n",
    "\n",
    "df['lat_lon'] = list(zip(lat, lon))\n",
    "pts = df['lat_lon']\n",
    "del df['lat_lon']\n",
    "\n",
    "sites = df_cells[\"Site\"]\n",
    "\n",
    "AQ_width = df.shape[1]\n",
    "LU_width = df_cells.shape[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "def parse_str(str_edit):\n",
    "    str_edit = str_edit.replace('[', '')\n",
    "    str_edit = str_edit.replace('(', '')\n",
    "    str_edit = str_edit.replace(']', '')\n",
    "    str_edit = str_edit.replace(')', '')\n",
    "    str_edit = str_edit.replace(',', '')\n",
    "    list = str_edit.split(' ')\n",
    "    return [(np.float64(list[0]), np.float64(list[1])), (np.float64(list[2]), np.float64(list[3])),\n",
    "            (np.float64(list[4]), np.float64(list[5])), (np.float64(list[6]), np.float64(list[7]))]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "def in_cell(lat, lon, cell):\n",
    "    cell_points = parse_str(cell)\n",
    "    lon_bool = lon >= cell_points[0][1] and lon <= cell_points[2][1]\n",
    "    lat_bool = lat >= cell_points[0][0] and lat <= cell_points[2][0]\n",
    "    if lat_bool and lon_bool:\n",
    "        return True\n",
    "    else:\n",
    "        return False"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "def add_columns(df):\n",
    "    df['Cropland'] = 0\n",
    "    df['Golf Course'] = 0\n",
    "    df['Saltwater Sandy Beach'] = 0\n",
    "    df['cemetary'] = 0\n",
    "    df['commercial'] = 0\n",
    "    df['crop_land'] = 0\n",
    "    df['forest'] = 0\n",
    "    df['high_density_residential'] = 0\n",
    "    df['industrial'] = 0\n",
    "    df['low_density_residential'] = 0\n",
    "    df['marina'] = 0\n",
    "    df['medium_density_residential'] = 0\n",
    "    df['mining'] = 0\n",
    "    df['open_land'] = 0\n",
    "    df['recreational'] = 0\n",
    "    df['transitional'] = 0\n",
    "    df['transportation'] = 0\n",
    "    df['urban_public/institutional'] = 0\n",
    "    df['waste'] = 0\n",
    "    df['water'] = 0\n",
    "    df['wetland'] = 0\n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "def update_proportions(AQ_df, LU_df, AQ_index, LU_index):\n",
    "    #AQ_df is the Boston AQ hourly\n",
    "    #LU_df contains the cells and the landuse\n",
    "    #AQ_index is the row of the cell that contains the point in the Boston AQ hourly df\n",
    "    #LU_index is the row of the cell that contains the point in the cell and landuse df\n",
    "    for col in range(0, LU_width - 2):#df.loc[i, 'forest'] = df.loc[i, 'forest'] + my_dict['forest']\n",
    "#         print (AQ_index, AQ_width + col, LU_index, col + 1), \"\\n\"\n",
    "#         print AQ_df.iloc[AQ_index, col + AQ_width], \"LU:\", LU_df.iloc[LU_index, col+2]\n",
    "        AQ_df.iloc[AQ_index, col + AQ_width] = LU_df.iloc[LU_index, col + 2]\n",
    "    return AQ_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "df = add_columns(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "for pt in range(len(pts)): # pt is row for df\n",
    "    for cell in range(len(sites)): #cell is row for df_cells\n",
    "        if in_cell(pts[pt][1], pts[pt][0], df_cells[\"Site\"][cell]):\n",
    "            update_proportions(df, df_cells, pt, cell)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>State Code</th>\n",
       "      <th>County Code</th>\n",
       "      <th>Tribal Code</th>\n",
       "      <th>Site ID</th>\n",
       "      <th>Support Agency Code</th>\n",
       "      <th>Location Address</th>\n",
       "      <th>City Code</th>\n",
       "      <th>Postal Code</th>\n",
       "      <th>Local ID</th>\n",
       "      <th>...</th>\n",
       "      <th>medium_density_residential</th>\n",
       "      <th>mining</th>\n",
       "      <th>open_land</th>\n",
       "      <th>recreational</th>\n",
       "      <th>transitional</th>\n",
       "      <th>transportation</th>\n",
       "      <th>urban_public/institutional</th>\n",
       "      <th>waste</th>\n",
       "      <th>water</th>\n",
       "      <th>wetland</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>8</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>9</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>10</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>11</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>13</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>14</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>15</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>16</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>17</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>18</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>19</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>20</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>21</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250042</td>\n",
       "      <td>'0660</td>\n",
       "      <td>HARRISON AV</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02119</td>\n",
       "      <td>Boston Roxbury</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.19</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>22</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250044</td>\n",
       "      <td>'0660</td>\n",
       "      <td>19 Von Hillern Street</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02125</td>\n",
       "      <td>Boston Von Hillern</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>23</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250044</td>\n",
       "      <td>'0660</td>\n",
       "      <td>19 Von Hillern Street</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02125</td>\n",
       "      <td>Boston Von Hillern</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>24</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250044</td>\n",
       "      <td>'0660</td>\n",
       "      <td>19 Von Hillern Street</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02125</td>\n",
       "      <td>Boston Von Hillern</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>25</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250044</td>\n",
       "      <td>'0660</td>\n",
       "      <td>19 Von Hillern Street</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02125</td>\n",
       "      <td>Boston Von Hillern</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>26</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250044</td>\n",
       "      <td>'0660</td>\n",
       "      <td>19 Von Hillern Street</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02125</td>\n",
       "      <td>Boston Von Hillern</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>27</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250044</td>\n",
       "      <td>'0660</td>\n",
       "      <td>19 Von Hillern Street</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02125</td>\n",
       "      <td>Boston Von Hillern</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>28</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250044</td>\n",
       "      <td>'0660</td>\n",
       "      <td>19 Von Hillern Street</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02125</td>\n",
       "      <td>Boston Von Hillern</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>29</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250250044</td>\n",
       "      <td>'0660</td>\n",
       "      <td>19 Von Hillern Street</td>\n",
       "      <td>7000</td>\n",
       "      <td>'02125</td>\n",
       "      <td>Boston Von Hillern</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>466</th>\n",
       "      <td>68</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>467</th>\n",
       "      <td>69</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>468</th>\n",
       "      <td>70</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>469</th>\n",
       "      <td>71</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>470</th>\n",
       "      <td>72</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>471</th>\n",
       "      <td>73</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>472</th>\n",
       "      <td>74</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>473</th>\n",
       "      <td>75</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>474</th>\n",
       "      <td>76</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>475</th>\n",
       "      <td>77</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>476</th>\n",
       "      <td>78</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>477</th>\n",
       "      <td>79</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>478</th>\n",
       "      <td>80</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>479</th>\n",
       "      <td>81</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>480</th>\n",
       "      <td>82</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>481</th>\n",
       "      <td>83</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>482</th>\n",
       "      <td>84</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>483</th>\n",
       "      <td>85</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>484</th>\n",
       "      <td>86</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>485</th>\n",
       "      <td>87</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>486</th>\n",
       "      <td>88</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>487</th>\n",
       "      <td>89</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>488</th>\n",
       "      <td>90</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>489</th>\n",
       "      <td>91</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>490</th>\n",
       "      <td>92</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>491</th>\n",
       "      <td>93</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>492</th>\n",
       "      <td>94</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>493</th>\n",
       "      <td>95</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>494</th>\n",
       "      <td>96</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>495</th>\n",
       "      <td>97</td>\n",
       "      <td>\\t\\t\\t\\tMA</td>\n",
       "      <td>'009</td>\n",
       "      <td>NaN</td>\n",
       "      <td>'250092006</td>\n",
       "      <td>'0660</td>\n",
       "      <td>390 PARKLAND</td>\n",
       "      <td>37490</td>\n",
       "      <td>'01905</td>\n",
       "      <td>Lynn Water Treatment Plant</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>496 rows × 54 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     Unnamed: 0 \\t\\tState Code County Code  Tribal Code     Site ID  \\\n",
       "0             0         \\t\\tMA        '025          NaN  '250250042   \n",
       "1             1     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "2             2     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "3             3     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "4             4     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "5             5     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "6             6     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "7             7     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "8             8     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "9             9     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "10           10     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "11           11     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "12           12     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "13           13     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "14           14     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "15           15     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "16           16     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "17           17     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "18           18     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "19           19     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "20           20     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "21           21     \\t\\t\\t\\tMA        '025          NaN  '250250042   \n",
       "22           22     \\t\\t\\t\\tMA        '025          NaN  '250250044   \n",
       "23           23     \\t\\t\\t\\tMA        '025          NaN  '250250044   \n",
       "24           24     \\t\\t\\t\\tMA        '025          NaN  '250250044   \n",
       "25           25     \\t\\t\\t\\tMA        '025          NaN  '250250044   \n",
       "26           26     \\t\\t\\t\\tMA        '025          NaN  '250250044   \n",
       "27           27     \\t\\t\\t\\tMA        '025          NaN  '250250044   \n",
       "28           28     \\t\\t\\t\\tMA        '025          NaN  '250250044   \n",
       "29           29     \\t\\t\\t\\tMA        '025          NaN  '250250044   \n",
       "..          ...            ...         ...          ...         ...   \n",
       "466          68     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "467          69     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "468          70     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "469          71     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "470          72     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "471          73     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "472          74     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "473          75     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "474          76     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "475          77     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "476          78     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "477          79     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "478          80     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "479          81     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "480          82     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "481          83     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "482          84     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "483          85     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "484          86     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "485          87     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "486          88     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "487          89     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "488          90     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "489          91     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "490          92     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "491          93     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "492          94     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "493          95     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "494          96     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "495          97     \\t\\t\\t\\tMA        '009          NaN  '250092006   \n",
       "\n",
       "    Support Agency Code       Location Address  City Code Postal Code  \\\n",
       "0                 '0660            HARRISON AV       7000      '02119   \n",
       "1                 '0660            HARRISON AV       7000      '02119   \n",
       "2                 '0660            HARRISON AV       7000      '02119   \n",
       "3                 '0660            HARRISON AV       7000      '02119   \n",
       "4                 '0660            HARRISON AV       7000      '02119   \n",
       "5                 '0660            HARRISON AV       7000      '02119   \n",
       "6                 '0660            HARRISON AV       7000      '02119   \n",
       "7                 '0660            HARRISON AV       7000      '02119   \n",
       "8                 '0660            HARRISON AV       7000      '02119   \n",
       "9                 '0660            HARRISON AV       7000      '02119   \n",
       "10                '0660            HARRISON AV       7000      '02119   \n",
       "11                '0660            HARRISON AV       7000      '02119   \n",
       "12                '0660            HARRISON AV       7000      '02119   \n",
       "13                '0660            HARRISON AV       7000      '02119   \n",
       "14                '0660            HARRISON AV       7000      '02119   \n",
       "15                '0660            HARRISON AV       7000      '02119   \n",
       "16                '0660            HARRISON AV       7000      '02119   \n",
       "17                '0660            HARRISON AV       7000      '02119   \n",
       "18                '0660            HARRISON AV       7000      '02119   \n",
       "19                '0660            HARRISON AV       7000      '02119   \n",
       "20                '0660            HARRISON AV       7000      '02119   \n",
       "21                '0660            HARRISON AV       7000      '02119   \n",
       "22                '0660  19 Von Hillern Street       7000      '02125   \n",
       "23                '0660  19 Von Hillern Street       7000      '02125   \n",
       "24                '0660  19 Von Hillern Street       7000      '02125   \n",
       "25                '0660  19 Von Hillern Street       7000      '02125   \n",
       "26                '0660  19 Von Hillern Street       7000      '02125   \n",
       "27                '0660  19 Von Hillern Street       7000      '02125   \n",
       "28                '0660  19 Von Hillern Street       7000      '02125   \n",
       "29                '0660  19 Von Hillern Street       7000      '02125   \n",
       "..                  ...                    ...        ...         ...   \n",
       "466               '0660           390 PARKLAND      37490      '01905   \n",
       "467               '0660           390 PARKLAND      37490      '01905   \n",
       "468               '0660           390 PARKLAND      37490      '01905   \n",
       "469               '0660           390 PARKLAND      37490      '01905   \n",
       "470               '0660           390 PARKLAND      37490      '01905   \n",
       "471               '0660           390 PARKLAND      37490      '01905   \n",
       "472               '0660           390 PARKLAND      37490      '01905   \n",
       "473               '0660           390 PARKLAND      37490      '01905   \n",
       "474               '0660           390 PARKLAND      37490      '01905   \n",
       "475               '0660           390 PARKLAND      37490      '01905   \n",
       "476               '0660           390 PARKLAND      37490      '01905   \n",
       "477               '0660           390 PARKLAND      37490      '01905   \n",
       "478               '0660           390 PARKLAND      37490      '01905   \n",
       "479               '0660           390 PARKLAND      37490      '01905   \n",
       "480               '0660           390 PARKLAND      37490      '01905   \n",
       "481               '0660           390 PARKLAND      37490      '01905   \n",
       "482               '0660           390 PARKLAND      37490      '01905   \n",
       "483               '0660           390 PARKLAND      37490      '01905   \n",
       "484               '0660           390 PARKLAND      37490      '01905   \n",
       "485               '0660           390 PARKLAND      37490      '01905   \n",
       "486               '0660           390 PARKLAND      37490      '01905   \n",
       "487               '0660           390 PARKLAND      37490      '01905   \n",
       "488               '0660           390 PARKLAND      37490      '01905   \n",
       "489               '0660           390 PARKLAND      37490      '01905   \n",
       "490               '0660           390 PARKLAND      37490      '01905   \n",
       "491               '0660           390 PARKLAND      37490      '01905   \n",
       "492               '0660           390 PARKLAND      37490      '01905   \n",
       "493               '0660           390 PARKLAND      37490      '01905   \n",
       "494               '0660           390 PARKLAND      37490      '01905   \n",
       "495               '0660           390 PARKLAND      37490      '01905   \n",
       "\n",
       "                       Local ID   ...   medium_density_residential  mining  \\\n",
       "0                Boston Roxbury   ...                          0.0     0.0   \n",
       "1                Boston Roxbury   ...                          0.0     0.0   \n",
       "2                Boston Roxbury   ...                          0.0     0.0   \n",
       "3                Boston Roxbury   ...                          0.0     0.0   \n",
       "4                Boston Roxbury   ...                          0.0     0.0   \n",
       "5                Boston Roxbury   ...                          0.0     0.0   \n",
       "6                Boston Roxbury   ...                          0.0     0.0   \n",
       "7                Boston Roxbury   ...                          0.0     0.0   \n",
       "8                Boston Roxbury   ...                          0.0     0.0   \n",
       "9                Boston Roxbury   ...                          0.0     0.0   \n",
       "10               Boston Roxbury   ...                          0.0     0.0   \n",
       "11               Boston Roxbury   ...                          0.0     0.0   \n",
       "12               Boston Roxbury   ...                          0.0     0.0   \n",
       "13               Boston Roxbury   ...                          0.0     0.0   \n",
       "14               Boston Roxbury   ...                          0.0     0.0   \n",
       "15               Boston Roxbury   ...                          0.0     0.0   \n",
       "16               Boston Roxbury   ...                          0.0     0.0   \n",
       "17               Boston Roxbury   ...                          0.0     0.0   \n",
       "18               Boston Roxbury   ...                          0.0     0.0   \n",
       "19               Boston Roxbury   ...                          0.0     0.0   \n",
       "20               Boston Roxbury   ...                          0.0     0.0   \n",
       "21               Boston Roxbury   ...                          0.0     0.0   \n",
       "22           Boston Von Hillern   ...                          0.0     0.0   \n",
       "23           Boston Von Hillern   ...                          0.0     0.0   \n",
       "24           Boston Von Hillern   ...                          0.0     0.0   \n",
       "25           Boston Von Hillern   ...                          0.0     0.0   \n",
       "26           Boston Von Hillern   ...                          0.0     0.0   \n",
       "27           Boston Von Hillern   ...                          0.0     0.0   \n",
       "28           Boston Von Hillern   ...                          0.0     0.0   \n",
       "29           Boston Von Hillern   ...                          0.0     0.0   \n",
       "..                          ...   ...                          ...     ...   \n",
       "466  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "467  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "468  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "469  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "470  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "471  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "472  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "473  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "474  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "475  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "476  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "477  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "478  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "479  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "480  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "481  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "482  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "483  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "484  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "485  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "486  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "487  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "488  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "489  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "490  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "491  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "492  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "493  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "494  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "495  Lynn Water Treatment Plant   ...                          0.0     0.0   \n",
       "\n",
       "    open_land recreational transitional transportation  \\\n",
       "0        0.03         0.00         0.01           0.07   \n",
       "1        0.03         0.00         0.01           0.07   \n",
       "2        0.03         0.00         0.01           0.07   \n",
       "3        0.03         0.00         0.01           0.07   \n",
       "4        0.03         0.00         0.01           0.07   \n",
       "5        0.03         0.00         0.01           0.07   \n",
       "6        0.03         0.00         0.01           0.07   \n",
       "7        0.03         0.00         0.01           0.07   \n",
       "8        0.03         0.00         0.01           0.07   \n",
       "9        0.03         0.00         0.01           0.07   \n",
       "10       0.03         0.00         0.01           0.07   \n",
       "11       0.03         0.00         0.01           0.07   \n",
       "12       0.03         0.00         0.01           0.07   \n",
       "13       0.03         0.00         0.01           0.07   \n",
       "14       0.03         0.00         0.01           0.07   \n",
       "15       0.03         0.00         0.01           0.07   \n",
       "16       0.03         0.00         0.01           0.07   \n",
       "17       0.03         0.00         0.01           0.07   \n",
       "18       0.03         0.00         0.01           0.07   \n",
       "19       0.03         0.00         0.01           0.07   \n",
       "20       0.03         0.00         0.01           0.07   \n",
       "21       0.03         0.00         0.01           0.07   \n",
       "22       0.00         0.22         0.00           0.08   \n",
       "23       0.00         0.22         0.00           0.08   \n",
       "24       0.00         0.22         0.00           0.08   \n",
       "25       0.00         0.22         0.00           0.08   \n",
       "26       0.00         0.22         0.00           0.08   \n",
       "27       0.00         0.22         0.00           0.08   \n",
       "28       0.00         0.22         0.00           0.08   \n",
       "29       0.00         0.22         0.00           0.08   \n",
       "..        ...          ...          ...            ...   \n",
       "466      0.00         0.00         0.00           0.00   \n",
       "467      0.00         0.00         0.00           0.00   \n",
       "468      0.00         0.00         0.00           0.00   \n",
       "469      0.00         0.00         0.00           0.00   \n",
       "470      0.00         0.00         0.00           0.00   \n",
       "471      0.00         0.00         0.00           0.00   \n",
       "472      0.00         0.00         0.00           0.00   \n",
       "473      0.00         0.00         0.00           0.00   \n",
       "474      0.00         0.00         0.00           0.00   \n",
       "475      0.00         0.00         0.00           0.00   \n",
       "476      0.00         0.00         0.00           0.00   \n",
       "477      0.00         0.00         0.00           0.00   \n",
       "478      0.00         0.00         0.00           0.00   \n",
       "479      0.00         0.00         0.00           0.00   \n",
       "480      0.00         0.00         0.00           0.00   \n",
       "481      0.00         0.00         0.00           0.00   \n",
       "482      0.00         0.00         0.00           0.00   \n",
       "483      0.00         0.00         0.00           0.00   \n",
       "484      0.00         0.00         0.00           0.00   \n",
       "485      0.00         0.00         0.00           0.00   \n",
       "486      0.00         0.00         0.00           0.00   \n",
       "487      0.00         0.00         0.00           0.00   \n",
       "488      0.00         0.00         0.00           0.00   \n",
       "489      0.00         0.00         0.00           0.00   \n",
       "490      0.00         0.00         0.00           0.00   \n",
       "491      0.00         0.00         0.00           0.00   \n",
       "492      0.00         0.00         0.00           0.00   \n",
       "493      0.00         0.00         0.00           0.00   \n",
       "494      0.00         0.00         0.00           0.00   \n",
       "495      0.00         0.00         0.00           0.00   \n",
       "\n",
       "     urban_public/institutional  waste water wetland  \n",
       "0                          0.19    0.0   0.0     0.0  \n",
       "1                          0.19    0.0   0.0     0.0  \n",
       "2                          0.19    0.0   0.0     0.0  \n",
       "3                          0.19    0.0   0.0     0.0  \n",
       "4                          0.19    0.0   0.0     0.0  \n",
       "5                          0.19    0.0   0.0     0.0  \n",
       "6                          0.19    0.0   0.0     0.0  \n",
       "7                          0.19    0.0   0.0     0.0  \n",
       "8                          0.19    0.0   0.0     0.0  \n",
       "9                          0.19    0.0   0.0     0.0  \n",
       "10                         0.19    0.0   0.0     0.0  \n",
       "11                         0.19    0.0   0.0     0.0  \n",
       "12                         0.19    0.0   0.0     0.0  \n",
       "13                         0.19    0.0   0.0     0.0  \n",
       "14                         0.19    0.0   0.0     0.0  \n",
       "15                         0.19    0.0   0.0     0.0  \n",
       "16                         0.19    0.0   0.0     0.0  \n",
       "17                         0.19    0.0   0.0     0.0  \n",
       "18                         0.19    0.0   0.0     0.0  \n",
       "19                         0.19    0.0   0.0     0.0  \n",
       "20                         0.19    0.0   0.0     0.0  \n",
       "21                         0.19    0.0   0.0     0.0  \n",
       "22                         0.00    0.0   0.0     0.0  \n",
       "23                         0.00    0.0   0.0     0.0  \n",
       "24                         0.00    0.0   0.0     0.0  \n",
       "25                         0.00    0.0   0.0     0.0  \n",
       "26                         0.00    0.0   0.0     0.0  \n",
       "27                         0.00    0.0   0.0     0.0  \n",
       "28                         0.00    0.0   0.0     0.0  \n",
       "29                         0.00    0.0   0.0     0.0  \n",
       "..                          ...    ...   ...     ...  \n",
       "466                        0.00    0.0   0.0     0.0  \n",
       "467                        0.00    0.0   0.0     0.0  \n",
       "468                        0.00    0.0   0.0     0.0  \n",
       "469                        0.00    0.0   0.0     0.0  \n",
       "470                        0.00    0.0   0.0     0.0  \n",
       "471                        0.00    0.0   0.0     0.0  \n",
       "472                        0.00    0.0   0.0     0.0  \n",
       "473                        0.00    0.0   0.0     0.0  \n",
       "474                        0.00    0.0   0.0     0.0  \n",
       "475                        0.00    0.0   0.0     0.0  \n",
       "476                        0.00    0.0   0.0     0.0  \n",
       "477                        0.00    0.0   0.0     0.0  \n",
       "478                        0.00    0.0   0.0     0.0  \n",
       "479                        0.00    0.0   0.0     0.0  \n",
       "480                        0.00    0.0   0.0     0.0  \n",
       "481                        0.00    0.0   0.0     0.0  \n",
       "482                        0.00    0.0   0.0     0.0  \n",
       "483                        0.00    0.0   0.0     0.0  \n",
       "484                        0.00    0.0   0.0     0.0  \n",
       "485                        0.00    0.0   0.0     0.0  \n",
       "486                        0.00    0.0   0.0     0.0  \n",
       "487                        0.00    0.0   0.0     0.0  \n",
       "488                        0.00    0.0   0.0     0.0  \n",
       "489                        0.00    0.0   0.0     0.0  \n",
       "490                        0.00    0.0   0.0     0.0  \n",
       "491                        0.00    0.0   0.0     0.0  \n",
       "492                        0.00    0.0   0.0     0.0  \n",
       "493                        0.00    0.0   0.0     0.0  \n",
       "494                        0.00    0.0   0.0     0.0  \n",
       "495                        0.00    0.0   0.0     0.0  \n",
       "\n",
       "[496 rows x 54 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "\"\"\"Preserve and use the pickled version so that we dont have to keep re-running the code above.\"\"\"\n",
    "df.to_pickle(\"boston_aq_w_landuse.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "df2 = pickle.load(open('boston_aq_w_landuse.csv', 'rb'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "\"\"\"\n",
    "Creates Gaussian model, computs r squarred, MSE and log liklihood\n",
    "Given x_train, y_train, x_test, and y_test data, and numerical alpha value\n",
    "Prints train and test R^2\n",
    "\n",
    "\"\"\"\n",
    "\n",
    "def gaussian(x_train, y_train, x_test, y_test, alpha):\n",
    "    \n",
    "    train_size = x_train.shape[0]\n",
    "    test_size = x_test.shape[0]\n",
    "    \n",
    "    kern = RBF(length_scale = 1)\n",
    "\n",
    "    gp = GaussianProcessRegressor(kernel=kern, alpha=alpha, optimizer='fmin_l_bfgs_b', n_restarts_optimizer=1, normalize_y=False, copy_X_train=False, random_state=None)\n",
    "    gp.fit(x_train, y_train.reshape(train_size, 1))\n",
    "\n",
    "    y_train_pred, sigma_train = gp.predict(x_train, return_std=True)\n",
    "    y_test_pred, sigma_test = gp.predict(x_test, return_std=True)\n",
    "\n",
    "    # get R^2\n",
    "    r2 = gp.score(x_train, y_train.reshape(train_size, 1))\n",
    "    r2_t = gp.score(x_test, y_test.reshape(test_size, 1))\n",
    "\n",
    "    # get MSE measurements\n",
    "    MSE_test = np.mean((y_test_pred - y_test.reshape(test_size, 1))**2)\n",
    "    MSE_train = np.mean((y_train_pred - y_train.reshape(train_size, 1))**2)\n",
    "\n",
    "    # get log likelihood\n",
    "    t=gp.log_marginal_likelihood()\n",
    "\n",
    "    # calculate AIC\n",
    "    AIC = 2*len(x_test) - 2*np.log(-t)\n",
    "    \n",
    "    # print R^2 values\n",
    "    print('mean squared error of train data with model = ' + str(MSE_train))\n",
    "    print('mean squared error of test data with model = ' + str(MSE_test))\n",
    "    print('Akaike information criterion = ' + str(AIC))\n",
    "    print('log likelihood of model = ' + str(t))\n",
    "    print('training R^2 value = ' + str(r2))\n",
    "    print('testing R^2 value = ' + str(r2_t)), \"\\n \\n\"\n",
    "    \n",
    "    return y_train_pred, y_test_pred, gp"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "\"\"\"Plots predicted y values for testing set\"\"\"\n",
    "def plot_predictions(x_test, y_test, y_test_pred, x_label, y_label):\n",
    "    print x_test.shape, y_test_pred.shape\n",
    "    plt.figure(figsize=(13,8))\n",
    "    plt.plot(x_test, y_test, \".\", color=\"r\",)\n",
    "    plt.scatter(x_test, y_test_pred)\n",
    "#     plt.xlabel(\"Time Occurred\")\n",
    "#     plt.title(\"Predicted Boston CO2 level\")\n",
    "#     plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "pollutants = ['CO', 'SO', 'NO', 'OZO', 'PM']\n",
    "# local_path = '/Users/kaelanelson/Documents/Tricam_temporary/Boston_AQ_Hourly/'\n",
    "col_names = ['Cropland', 'Golf Course',\n",
    "       'Saltwater Sandy Beach', 'cemetary', 'commercial', 'crop_land',\n",
    "       'forest', 'high_density_residential', 'industrial',\n",
    "       'low_density_residential', 'marina', 'medium_density_residential',\n",
    "       'mining', 'open_land', 'recreational', 'transitional', 'transportation',\n",
    "       'urban_public/institutional', 'waste', 'water', 'wetland', 'Sample Collection Start Time']\n",
    "\n",
    "# alpha = 0.009\n",
    "\n",
    "x_label = 'Time'\n",
    "y_label = 'Pollutant'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kaelanelson/anaconda/lib/python2.7/site-packages/ipykernel_launcher.py:16: FutureWarning: reshape is deprecated and will raise in a subsequent release. Please use .values.reshape(...) instead\n",
      "  app.launch_new_instance()\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "mean squared error of train data with model = 0.00127770805067\n",
      "mean squared error of test data with model = 0.00197280324347\n",
      "Akaike information criterion = nan\n",
      "log likelihood of model = 506.821616814\n",
      "training R^2 value = 0.72869004137\n",
      "testing R^2 value = 0.534267663583 \n",
      " \n",
      "\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kaelanelson/anaconda/lib/python2.7/site-packages/ipykernel_launcher.py:22: FutureWarning: reshape is deprecated and will raise in a subsequent release. Please use .values.reshape(...) instead\n",
      "/Users/kaelanelson/anaconda/lib/python2.7/site-packages/ipykernel_launcher.py:23: FutureWarning: reshape is deprecated and will raise in a subsequent release. Please use .values.reshape(...) instead\n",
      "/Users/kaelanelson/anaconda/lib/python2.7/site-packages/ipykernel_launcher.py:26: FutureWarning: reshape is deprecated and will raise in a subsequent release. Please use .values.reshape(...) instead\n",
      "/Users/kaelanelson/anaconda/lib/python2.7/site-packages/ipykernel_launcher.py:27: FutureWarning: reshape is deprecated and will raise in a subsequent release. Please use .values.reshape(...) instead\n",
      "/Users/kaelanelson/anaconda/lib/python2.7/site-packages/ipykernel_launcher.py:33: RuntimeWarning: invalid value encountered in log\n"
     ]
    }
   ],
   "source": [
    "# for pol in pollutants:\n",
    "\n",
    "#     filenames = get_filenames(local_path + pol + '/')\n",
    "\n",
    "#     DF = read_multiple_csvs(filenames, local_path + pol + '/')\n",
    "\n",
    "#     DF = clean_time_multiple(DF, 'Sample Collection Start Time')\n",
    "alpha = 0.0008\n",
    "\n",
    "train, test = train_test_split(df2)\n",
    "#df <- subset(df, select=c(g,a:f))\n",
    "x_train = train[col_names].values\n",
    "y_train = train[\"Measure Value\"]\n",
    "x_test = test[col_names].values\n",
    "y_test = test[\"Measure Value\"]\n",
    "\n",
    "y_train_pred, y_test_pred, gp = gaussian(x_train, y_train, x_test, y_test, alpha)\n",
    "\n",
    "#     plot_predictions(x_test, y_test, y_test_pred, x_label, y_label)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
